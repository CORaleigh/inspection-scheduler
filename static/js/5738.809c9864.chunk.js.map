{"version":3,"file":"static/js/5738.809c9864.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/2d/layers/WMTSLayerView2D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import{property as t}from\"../../../core/accessorSupport/decorators/property.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import\"../../../core/urlUtils.js\";import\"../../../core/uuid.js\";import\"../../../portal/support/resourceExtension.js\";import{isAbortError as s}from\"../../../core/promiseUtils.js\";import{geographicToWebMercator as r}from\"../../../geometry/support/webMercatorUtils.js\";import l from\"../../../core/Handles.js\";import{RefreshableLayerView as a}from\"../../layers/RefreshableLayerView.js\";import o from\"../tiling/TileInfoView.js\";import h from\"../tiling/TileQueue.js\";import u from\"../tiling/TileStrategy.js\";import n from\"../../layers/LayerView.js\";import{LayerView2DMixin as c}from\"./LayerView2D.js\";import{BitmapTileLayerView2D as p}from\"./BitmapTileLayerView2D.js\";const f=[102113,102100,3857,3785,900913];let d=class extends(a(p(c(n)))){constructor(){super(...arguments),this._handles=new l,this._tileStrategy=null,this._fetchQueue=null,this._tileRequests=new Map,this.layer=null}get tileMatrixSet(){if(this.layer.activeLayer.tileMatrixSetId)return this.layer.activeLayer.tileMatrixSet;const e=this._getTileMatrixSetBySpatialReference(this.layer.activeLayer);return e?(this.layer.activeLayer.tileMatrixSetId=e.id,e):null}hitTest(){return null}update(e){this._fetchQueue.pause(),this._fetchQueue.state=e.state,this._tileStrategy.update(e),this._fetchQueue.resume(),this.notifyChange(\"updating\")}attach(){const e=this.layer.activeLayer,t=this.tileMatrixSet;if(!t)return;const i=t.tileInfo.spatialReference;let s=e.fullExtent&&e.fullExtent.clone();i.isWebMercator?s=r(s):i.isWGS84||(s=t.fullExtent),this._tileInfoView=new o(t.tileInfo,s),this._fetchQueue=new h({tileInfoView:this._tileInfoView,process:e=>this.fetchTile(e)}),this._tileStrategy=new u({cachePolicy:\"keep\",acquireTile:e=>this.acquireTile(e),releaseTile:e=>this.releaseTile(e),tileInfoView:this._tileInfoView}),this._handles.add(this.watch([\"layer.activeLayer.styleId\",\"tileMatrixSet\"],(()=>this._refresh()))),super.attach()}detach(){super.detach(),this._handles.removeAll(),this._tileStrategy.destroy(),this._fetchQueue.clear(),this._fetchQueue=this._tileStrategy=this._tileInfoView=null}moveStart(){this.requestUpdate()}viewChange(){this.requestUpdate()}moveEnd(){this.requestUpdate()}async doRefresh(){this.updateRequested||this.suspended||this._refresh()}isUpdating(){return this._fetchQueue.length>0}acquireTile(e){const t=this._bitmapView.createTile(e),i=t.bitmap;[i.x,i.y]=this._tileInfoView.getTileCoords([0,0],t.key),i.resolution=this._tileInfoView.getTileResolution(t.key),[i.width,i.height]=this._tileInfoView.tileInfo.size,this._tileInfoView.getTileCoords(i,t.key);const r={id:e.id,fulfilled:!1,promise:this._fetchQueue.push(t.key).then((e=>{t.bitmap.source=e,t.once(\"attach\",(()=>this.requestUpdate())),this._bitmapView.addChild(t)})).catch((e=>{s(e)||(t.bitmap.source=null,t.once(\"attach\",(()=>this.requestUpdate())),this._bitmapView.addChild(t))}))};return r.promise.finally((()=>r.fulfilled=!0)),this._tileRequests.set(t,r),this.requestUpdate(),t}releaseTile(e){const t=this._tileRequests.get(e);t.fulfilled||this._fetchQueue.abort(t.id),this._tileRequests.delete(e),this._bitmapView.removeChild(e),e.once(\"detach\",(()=>e.destroy())),this.requestUpdate()}async fetchTile(e){return this.layer.fetchTile(e.level,e.row,e.col)}canResume(){const e=super.canResume();return e?null!==this.tileMatrixSet:e}_refresh(){this._fetchQueue.reset(),this._tileStrategy.tiles.forEach((e=>{if(!e.bitmap.source)return;e.bitmap.source=null;const t={id:e.key.id,fulfilled:!1,promise:this._fetchQueue.push(e.key).then((t=>{e.bitmap.source=t,e.requestRender(),this.notifyChange(\"updating\")}))};t.promise.then((()=>t.fulfilled=!0),(()=>t.fulfilled=!0)),this._tileRequests.set(e,t)})),this.notifyChange(\"updating\")}_getTileMatrixSetBySpatialReference(e){const t=this.view.spatialReference;if(!e.tileMatrixSets)return null;let i=e.tileMatrixSets.find((e=>e.tileInfo.spatialReference.wkid===t.wkid));return!i&&t.isWebMercator&&(i=e.tileMatrixSets.find((e=>f.indexOf(e.tileInfo.spatialReference.wkid)>-1))),i}};e([t()],d.prototype,\"suspended\",void 0),e([t({readOnly:!0})],d.prototype,\"tileMatrixSet\",null),d=e([i(\"esri.views.2d.layers.WMTSLayerView2D\")],d);var m=d;export default m;\n"],"names":["f","d","a","p","c","n","constructor","super","arguments","this","_handles","l","_tileStrategy","_fetchQueue","_tileRequests","Map","layer","tileMatrixSet","activeLayer","tileMatrixSetId","e","_getTileMatrixSetBySpatialReference","id","hitTest","update","pause","state","resume","notifyChange","attach","t","i","tileInfo","spatialReference","s","fullExtent","clone","isWebMercator","r","isWGS84","_tileInfoView","o","h","tileInfoView","process","fetchTile","u","cachePolicy","acquireTile","releaseTile","add","watch","_refresh","detach","removeAll","destroy","clear","moveStart","requestUpdate","viewChange","moveEnd","doRefresh","updateRequested","suspended","isUpdating","length","_bitmapView","createTile","bitmap","x","y","getTileCoords","key","resolution","getTileResolution","width","height","size","fulfilled","promise","push","then","source","once","addChild","catch","finally","set","get","abort","delete","removeChild","level","row","col","canResume","reset","tiles","forEach","requestRender","view","tileMatrixSets","find","wkid","indexOf","prototype","readOnly"],"sourceRoot":""}