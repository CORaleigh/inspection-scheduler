"use strict";(globalThis.webpackChunkinspections_app=globalThis.webpackChunkinspections_app||[]).push([[8829],{58971:(e,t,a)=>{a.d(t,{G6:()=>I,Ie:()=>w,J9:()=>z,RF:()=>y,U1:()=>M,vY:()=>o,ym:()=>C});var i=a(77981);const r=(e,t,a)=>[t,a],n=(e,t,a)=>[t,a,e[2]],s=(e,t,a)=>[t,a,e[2],e[3]];function o(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:e.extent?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function l({scale:e,translate:t},a){return Math.round((a-t[0])/e[0])}function h({scale:e,translate:t},a){return Math.round((t[1]-a)/e[1])}function c(e,t,a){const i=[];let r,n,s,o;for(let c=0;c<a.length;c++){const m=a[c];c>0?(s=l(e,m[0]),o=h(e,m[1]),s===r&&o===n||(i.push(t(m,s-r,o-n)),r=s,n=o)):(r=l(e,m[0]),n=h(e,m[1]),i.push(t(m,r,n)))}return i.length>0?i:null}function m({scale:e,translate:t},a){return a*e[0]+t[0]}function f({scale:e,translate:t},a){return t[1]-a*e[1]}function u(e,t,a){const i=new Array(a.length);if(!a.length)return i;const[r,n]=e.scale;let s=m(e,a[0][0]),o=f(e,a[0][1]);i[0]=t(a[0],s,o);for(let l=1;l<a.length;l++){const e=a[l];s+=e[0]*r,o-=e[1]*n,i[l]=t(e,s,o)}return i}function g(e,t,a){const i=new Array(a.length);for(let r=0;r<a.length;r++)i[r]=u(e,t,a[r]);return i}function d(e,t,a,i,o){return t.points=function(e,t,a,i){return c(e,a?i?s:n:i?n:r,t)}(e,a.points,i,o),t}function y(e,t,a,i,r){return t.x=l(e,a.x),t.y=h(e,a.y),t!==a&&(i&&(t.z=a.z),r&&(t.m=a.m)),t}function p(e,t,a,i,o){const l=function(e,t,a,i){const o=[],l=a?i?s:n:i?n:r;for(let r=0;r<t.length;r++){const a=c(e,l,t[r]);a&&a.length>=3&&o.push(a)}return o.length?o:null}(e,a.rings,i,o);return l?(t.rings=l,t):null}function x(e,t,a,i,o){const l=function(e,t,a,i){const o=[],l=a?i?s:n:i?n:r;for(let r=0;r<t.length;r++){const a=c(e,l,t[r]);a&&a.length>=2&&o.push(a)}return o.length?o:null}(e,a.paths,i,o);return l?(t.paths=l,t):null}function C(e,t){return e&&t?(0,i.wp)(t)?y(e,{},t,!1,!1):(0,i.l9)(t)?x(e,{},t,!1,!1):(0,i.oU)(t)?p(e,{},t,!1,!1):(0,i.aW)(t)?d(e,{},t,!1,!1):(0,i.YX)(t)?(s=!1,o=!1,(r={}).xmin=l(a=e,(n=t).xmin),r.ymin=h(a,n.ymin),r.xmax=l(a,n.xmax),r.ymax=h(a,n.ymax),r!==n&&(s&&(r.zmin=n.zmin,r.zmax=n.zmax),o&&(r.mmin=n.mmin,r.mmax=n.mmax)),r):null:null;var a,r,n,s,o}function z(e,t,a,i,o){return t.points=function(e,t,a,i){return u(e,a?i?s:n:i?n:r,t)}(e,a.points,i,o),t}function M(e,t,a,i,r){return t.x=m(e,a.x),t.y=f(e,a.y),t!==a&&(i&&(t.z=a.z),r&&(t.m=a.m)),t}function w(e,t,a,i,o){return t.rings=function(e,t,a,i){return g(e,a?i?s:n:i?n:r,t)}(e,a.rings,i,o),t}function I(e,t,a,i,o){return t.paths=function(e,t,a,i){return g(e,a?i?s:n:i?n:r,t)}(e,a.paths,i,o),t}},16285:(e,t,a)=>{a.d(t,{Z:()=>o});var i=a(31027),r=a(691),n=a(2853),s=a(6388);const o=class{dispose(){this._rasterizationCanvas=null}rasterizeJSONResource(e,t,a){if(this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas")),"simple-fill"===e.type||"esriSFS"===e.type){const[a,i,r]=n.fN.rasterizeSimpleFill(this._rasterizationCanvas,e.style,t);return{size:[i,r],image:new Uint32Array(a.buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0}}if("simple-line"===e.type||"esriSLS"===e.type){const[t,a,i]=n.fN.rasterizeSimpleLine(e.style,e.cap);return{size:[a,i],image:new Uint32Array(t.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}}let i,o,l;if("simple-marker"===e.type||"esriSMS"===e.type||"line-marker"===e.type?(i=n.B$.fromSimpleMarker(e),l=(0,s.Fp)(i)):"CIMHatchFill"===e.type?(i=n.B$.fromCIMHatchFill(e),o=new r.Z(i.frame.xmin,-i.frame.ymax,i.frame.xmax-i.frame.xmin,i.frame.ymax-i.frame.ymin)):e.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===e.markerPlacement.type?(i=n.B$.fromCIMInsidePolygon(e),o=new r.Z(i.frame.xmin,-i.frame.ymax,i.frame.xmax-i.frame.xmin,i.frame.ymax-i.frame.ymin)):(i=e,l=(0,s.Fp)(i)),l&&!a){const[e,t,a]=(0,s.RL)(l);return e?{size:[t,a],image:new Uint32Array(e.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null}const[h,c,m,f,u]=n.B$.rasterize(this._rasterizationCanvas,i,o,!a);return h?{size:[c,m],image:new Uint32Array(h.buffer),sdf:!1,simplePattern:!1,anchorX:f,anchorY:u}:null}rasterizeImageResource(e,t,a,r){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas")),this._rasterizationCanvas.width=e,this._rasterizationCanvas.height=t;const n=this._rasterizationCanvas.getContext("2d");a instanceof ImageData?n.putImageData(a,0,0):(a.setAttribute("width",`${e}px`),a.setAttribute("height",`${t}px`),n.drawImage(a,0,0,e,t));const s=n.getImageData(0,0,e,t),o=new Uint8Array(s.data);if(r)for(const i of r)if(i&&i.oldColor&&4===i.oldColor.length&&i.newColor&&4===i.newColor.length){const[e,t,a,r]=i.oldColor,[n,s,l,h]=i.newColor;if(e===n&&t===s&&a===l&&r===h)continue;for(let i=0;i<o.length;i+=4)e===o[i]&&t===o[i+1]&&a===o[i+2]&&r===o[i+3]&&(o[i]=n,o[i+1]=s,o[i+2]=l,o[i+3]=h)}let l;for(let i=0;i<o.length;i+=4)l=o[i+3]/255,o[i]=o[i]*l,o[i+1]=o[i+1]*l,o[i+2]=o[i+2]*l;let h=o,c=e,m=t;const f=512;if(c>=f||m>=f){const a=c/m;a>1?(c=f,m=Math.round(f/a)):(m=f,c=Math.round(f*a)),h=new Uint8Array(4*c*m);const r=new Uint8ClampedArray(h.buffer);(0,i.TT)(o,e,t,r,c,m,!1)}return{size:[e,t],image:new Uint32Array(h.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}}},86894:(e,t,a)=>{a.d(t,{previewCIMSymbol:()=>M});var i=a(17842),r=a(49729),n=a(643),s=a(66978),o=a(77981),l=a(83748),h=a(41499),c=a(31027),m=a(79815),f=a(16285);class u{constructor(){}rasterizeText(e,t){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const a=this._textRasterizationCanvas,i=a.getContext("2d");this.setFontProperties(i,t),this.parameters=t,this.textLines=e.split(/\r?\n/),this.lineHeight=this.computeLineHeight();const r=this.computeTextWidth(i,t),n=this.lineHeight*this.textLines.length;a.width=r,a.height=n,this.renderedLineHeight=Math.round(this.lineHeight*t.pixelRatio),this.renderedHaloSize=t.halo.size*t.pixelRatio,this.renderedWidth=r*t.pixelRatio,this.renderedHeight=n*t.pixelRatio,this.fillStyle=function(e){return`rgba(${e.slice(0,3).toString()},${e[3]})`}(t.color),this.haloStyle=function(e){return`rgb(${e.slice(0,3).toString()})`}(t.halo.color);const s=this.renderedLineHeight,o=this.renderedHaloSize;this.setFontProperties(i,t);const l=function(e,t){return"center"===e?.5*t:"right"===e?t:0}(i.textAlign,this.renderedWidth)+o,h=o;let c=0,m=0;o>0&&this.renderHalo(i,l,h,c,m,t),m+=h,c+=l;for(const g of this.textLines)i.globalCompositeOperation="destination-out",i.fillStyle="rgb(0, 0, 0)",i.fillText(g,c,m),i.globalCompositeOperation="source-over",i.fillStyle=this.fillStyle,i.fillText(g,c,m),m+=s;const f=i.getImageData(0,0,this.renderedWidth,this.renderedHeight),u=new Uint8Array(f.data);if(t.premultiplyColors){let e;for(let t=0;t<u.length;t+=4)e=u[t+3]/255,u[t]=u[t]*e,u[t+1]=u[t+1]*e,u[t+2]=u[t+2]*e}return{size:[this.renderedWidth,this.renderedHeight],image:new Uint32Array(u.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}renderHalo(e,t,a,i,r,n){const s=this.renderedWidth,o=this.renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas")),this._haloRasterizationCanvas.width=s,this._haloRasterizationCanvas.height=o;const l=this._haloRasterizationCanvas,h=l.getContext("2d");h.clearRect(0,0,s,o),this.setFontProperties(h,n),h.fillStyle=this.haloStyle,h.strokeStyle=this.haloStyle;const c=this.renderedHaloSize<3;h.lineJoin=c?"miter":"round",c?this.renderHaloEmulated(h,t,a):this.renderHaloNative(h,t,a),e.globalAlpha=this.parameters.halo.color[3],e.drawImage(l,0,0,s,o,i,r,s,o),e.globalAlpha=1}renderHaloEmulated(e,t,a){const i=this.renderedLineHeight,r=this.renderedHaloSize;for(const n of this.textLines){for(const[i,s]of g)e.fillText(n,t+r*i,a+r*s);a+=i}}renderHaloNative(e,t,a){const i=this.renderedLineHeight,r=this.renderedHaloSize;for(const n of this.textLines){const s=2*r,o=5,l=.1;for(let i=0;i<o;i++){const r=1-(o-1)*l+i*l;e.lineWidth=r*s,e.strokeText(n,t,a)}a+=i}}setFontProperties(e,t){const a=t.font,r=`${a.style} ${a.weight} ${(0,i.F2)(t.size*t.pixelRatio)}px ${a.family}, sans-serif`;let n;switch(e.font=r,e.textBaseline="top",t.horizontalAlignment){case"left":default:n="left";break;case"right":n="right";break;case"center":n="center"}e.textAlign=n}computeTextWidth(e,t){let a=0;for(const r of this.textLines)a=Math.max(a,e.measureText(r).width);const i=t.font;return("italic"===i.style||"oblique"===i.style||"string"==typeof i.weight&&("bold"===i.weight||"bolder"===i.weight)||"number"==typeof i.weight&&i.weight>600)&&(a+=.3*e.measureText("A").width),a+=2*this.parameters.halo.size,Math.round(a)}computeLineHeight(){const e=1.275*this.parameters.size;return Math.round(e+2*this.parameters.halo.size)}}const g=[];{const e=16;for(let t=0;t<360;t+=360/e)g.push([Math.cos(Math.PI*t/180),Math.sin(Math.PI*t/180)])}var d;!function(e){e.Legend="legend",e.Preview="preview"}(d||(d={}));const y=(e,t,a)=>{if(e&&e.targetSize){let r;if(a){const t=Math.max(a.frame.xmax-a.frame.xmin,a.frame.ymax-a.frame.ymin);r=e.targetSize/(0,i.F2)(t)}else r=e.targetSize/t.referenceSize;return r}return e&&e.scaleFactor?e.scaleFactor:1},p={fill:{legend:{frame:{xmax:15,xmin:0,ymax:15,ymin:0},geometry:{rings:[[[0,15],[15,7.5],[15,0],[0,0],[0,15]]]},canvasPaths:{rings:[[[0,15],[0,0],[15,7.5],[15,15],[0,15]]]}},preview:{frame:{xmax:100,xmin:0,ymax:100,ymin:0},geometry:{rings:[[[0,100],[100,100],[100,0],[0,0],[0,100]]]},canvasPaths:{rings:[[[0,100],[0,0],[100,0],[100,100],[0,100]]]}}},stroke:{legend:{frame:{xmax:24,xmin:0,ymax:-2,ymin:2},geometry:{paths:[[[0,0],[12,0],[24,0]]]},canvasPaths:{paths:[[[0,2],[12,2],[24,2]]]}},preview:{frame:{xmax:100,xmin:0,ymax:-2,ymin:2},geometry:{paths:[[[0,0],[50,0],[100,0]]]},canvasPaths:{paths:[[[0,2],[50,2],[100,2]]]}}}};function x(e,t,a,i){let r,n;return"function"==typeof e.materialHash?(r=(0,e.materialHash)(t,a,i),n=(0,m.S)(e.cim,e.materialOverrides)):(r=e.materialHash,n=e.cim),{analyzedCIM:n,hash:r}}const C=new class{constructor(e,t){this._spatialReference=e,this._avoidSDF=t,this._resourceCache=new Map,this._rasterizer=new f.Z,this._textRasterizer=new u,this._pictureMarkerCache=new Map}async rasterizeCIMSymbolAsync(e,t,a,i,r,n,s,l){i=i||(t?null!=t.centroid?"esriGeometryPolygon":(0,o.Ji)(t.geometry):null)||function(e){if(!(e&&e.data&&e.data.symbol))return null;switch(e.data.symbol.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}(e);const h=await this.analyzeCIMSymbol(e,t?function(e){return(e?Object.keys(e):[]).map((t=>({name:t,alias:t,type:"string"==typeof e[t]?"esriFieldTypeString":"esriFieldTypeDouble"})))}(t.attributes):null,a,i,l);return this.rasterizeCIMSymbol(h,t,i,r,n,s)}async analyzeCIMSymbol(e,t,a,i,r){const n=[],o=t?{geometryType:i,spatialReference:this._spatialReference,fields:t}:null;let l;await(0,m.c)(e.data,o,n,this._avoidSDF),(0,s.k_)(r);for(const s of n)"CIMPictureMarker"!==s.cim.type&&"CIMPictureFill"!==s.cim.type&&"CIMPictureStroke"!==s.cim.type||(l||(l=[]),l.push(this.fetchPictureMarkerResource(s,r))),a&&"text"===s.type&&"string"==typeof s.text&&s.text.indexOf("[")>-1&&(s.text=(0,c.Qs)(a,s.text,s.cim.textCase));return l&&await Promise.all(l),n}async fetchPictureMarkerResource(e,t){const a=e.materialHash;if(!this._pictureMarkerCache.get(a)){const i=(await(0,h.default)(e.cim.url,{responseType:"image",signal:t&&t.signal})).data;this._pictureMarkerCache.set(a,i)}}rasterizeCIMSymbol(e,t,a,i,r,n){const s=[];for(const o of e){i&&"function"==typeof i.scaleFactor&&(i.scaleFactor=i.scaleFactor(t,r,n));const e=this._getRasterizedResource(o,t,a,i,r,n);if(!e)continue;let l=0,h=e.anchorX||0,m=e.anchorY||0,f=!1,u=0,g=0;if("esriGeometryPoint"===a){const e=y(i,o,null);if(u=(0,c.hf)(o.offsetX,t,r,n)*e||0,g=(0,c.hf)(o.offsetY,t,r,n)*e||0,"marker"===o.type)l=(0,c.hf)(o.rotation,t,r,n)||0,f=!!o.rotateClockwise&&o.rotateClockwise;else if("text"===o.type){if(l=(0,c.hf)(o.angle,t,r,n)||0,void 0!==o.horizontalAlignment)switch(o.horizontalAlignment){case"left":h=-.5;break;case"right":h=.5;break;default:h=0}if(void 0!==o.verticalAlignment)switch(o.verticalAlignment){case"top":m=.5;break;case"bottom":m=-.5;break;case"baseline":m=-.25;break;default:m=0}}}null!=e&&s.push({angle:l,rotateClockWise:f,anchorX:h,anchorY:m,offsetX:u,offsetY:g,rasterizedResource:e})}return this.getSymbolImage(s)}getSymbolImage(e){const t=document.createElement("canvas"),a=t.getContext("2d");let r=0,n=0,s=0,o=0;const h=[];for(let l=0;l<e.length;l++){const t=e[l],c=t.rasterizedResource;if(!c)continue;const m=c.size,f=t.offsetX,u=t.offsetY,g=t.anchorX,d=t.anchorY,y=t.rotateClockWise||!1;let p=t.angle,x=(0,i.F2)(f)-m[0]*(.5+g),C=(0,i.F2)(u)-m[1]*(.5+d),z=x+m[0],M=C+m[1];if(p){y&&(p=-p);const e=Math.sin(p*Math.PI/180),t=Math.cos(p*Math.PI/180),a=x*t-C*e,i=x*e+C*t,r=x*t-M*e,n=x*e+M*t,s=z*t-M*e,o=z*e+M*t,l=z*t-C*e,h=z*e+C*t;x=Math.min(a,r,s,l),C=Math.min(i,n,o,h),z=Math.max(a,r,s,l),M=Math.max(i,n,o,h)}r=x<r?x:r,n=C<n?C:n,s=z>s?z:s,o=M>o?M:o;const w=a.createImageData(c.size[0],c.size[1]);w.data.set(new Uint8ClampedArray(c.image.buffer));const I={offsetX:f,offsetY:u,rotateClockwise:y,angle:p,rasterizedImage:w,anchorX:g,anchorY:d};h.push(I)}t.width=s-r,t.height=o-n;const c=-r,m=o;for(let l=0;l<h.length;l++){const e=h[l],t=this._imageDataToCanvas(e.rasterizedImage),r=e.rasterizedImage.width,n=e.rasterizedImage.height,s=c-r*(.5+e.anchorX),o=m-n*(.5-e.anchorY);if(e.angle){const r=(360-e.angle)*Math.PI/180;a.save(),a.translate((0,i.F2)(e.offsetX),-(0,i.F2)(e.offsetY)),a.translate(c,m),a.rotate(r),a.translate(-c,-m),a.drawImage(t,s,o),a.restore()}else a.drawImage(t,s+(0,i.F2)(e.offsetX),o-(0,i.F2)(e.offsetY))}const f=new l.Z({x:c/t.width-.5,y:m/t.height-.5});return{imageData:0!==t.width&&0!==t.height?a.getImageData(0,0,t.width,t.height):a.createImageData(1,1),anchorPosition:f}}_imageDataToCanvas(e){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));const t=this._imageDataCanvas,a=t.getContext("2d");return t.width=e.width,t.height=e.height,a.putImageData(e,0,0),t}_imageTo32Array(e,t,a){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));const i=this._imageDataCanvas,r=i.getContext("2d");return i.width=t,i.height=a,r.drawImage(e,0,0,t,a),new Uint32Array(r.getImageData(0,0,t,a).data.buffer)}_getRasterizedResource(e,t,a,i,s,o){let l,h,m,f;if("esriGeometryPolyline"===a||"esriGeometryPolygon"===a){const r=i&&i.style?i.style:d.Legend,f="esriGeometryPolyline"===a?p.stroke[r]:p.fill[r];if("line"===e.type){if("CIMSolidStroke"!==e.cim.type){if("CIMPictureStroke"===e.cim.type){const a=(0,c.hf)(e.width,t,s,o),{image:i,width:r,height:n}=this._getPictureResource(e,a);return this._rasterizePictureResource(e,i,r,n,f,a)}return null}({analyzedCIM:l,hash:m}=x(e,t,s,o)),h=this._embedCIMLayerInVectorMarker(l,f)}else if("marker"===e.type){if("CIMPictureMarker"===e.cim.type)return null;if("CIMVectorMarker"!==e.cim.type)return null;e.cim.offsetX=(0,c.hf)(e.offsetX,t,s,o),e.cim.offsetY=(0,c.hf)(e.offsetY,t,s,o),e.cim.rotation=(0,c.hf)(e.rotation,t,s,o),e.cim.markerPlacement=e.markerPlacement,({analyzedCIM:l}=x(e,t,s,o)),m=(0,n.hP)(JSON.stringify(l)).toString(),h=this._embedCIMLayerInVectorMarker(l,f)}else{if("text"===e.type)return null;if("fill"===e.type){if("CIMHatchFill"===e.cim.type||"CIMVectorMarker"===e.cim.type||"CIMPictureMarker"===e.cim.type||"CIMPictureFill"===e.cim.type){const a=e.cim.size||e.cim.height;let i,r,n;if("CIMPictureMarker"===e.cim.type||"CIMPictureFill"===e.cim.type)({image:i,width:r,height:n}=this._getPictureResource(e,a));else{({analyzedCIM:l,hash:m}=x(e,t,s,o));const a=this._rasterizer.rasterizeJSONResource(l,1,this._avoidSDF);i=a.image,r=a.size[0],n=a.size[1]}return this._rasterizePictureResource(e,i,r,n,f,null)}if("CIMSolidFill"!==e.cim.type)return null;({analyzedCIM:l,hash:m}=x(e,t,s,o)),h=this._embedCIMLayerInVectorMarker(l,f)}}}else{if("text"===e.type)return f=this._rasterizeTextResource(e,t,i,s,o),f;({analyzedCIM:l,hash:m}=x(e,t,s,o));const a=y(i,e,null);if("CIMPictureMarker"===e.cim.type){const i=(0,c.hf)(e.size,t,s,o)*a,{image:r,width:n,height:l}=this._getPictureResource(e,i);return f={image:r,size:[n,l],sdf:!1,simplePattern:!1,anchorX:e.anchorPoint?e.anchorPoint.x:0,anchorY:e.anchorPoint?e.anchorPoint.y:0},f}(0,r.FW)(l,a,{preserveOutlineWidth:!1}),h=l}m+=a,i&&(m+=JSON.stringify(i));const u=this._resourceCache;return u.has(m)?u.get(m):(f=this._rasterizer.rasterizeJSONResource(h,window.devicePixelRatio||1,this._avoidSDF),u.set(m,f),f)}_rasterizeTextResource(e,t,a,i,r){const n=y(a,e,null),s=(0,c.hf)(e.text,t,i,r);if(!s||0===s.length)return null;const o=(0,c.hf)(e.fontName,t,i,r),l=(0,c.hf)(e.style,t,i,r),h=(0,c.hf)(e.weight,t,i,r),m=(0,c.hf)(e.decoration,t,i,r),f=(0,c.hf)(e.size,t,i,r)*n,u=(0,c.hf)(e.horizontalAlignment,t,i,r),g=(0,c.hf)(e.verticalAlignment,t,i,r),d=(0,c.nn)((0,c.hf)(e.color,t,i,r)),p=(0,c.nn)((0,c.hf)(e.outlineColor,t,i,r)),x={color:d,size:f,horizontalAlignment:u,verticalAlignment:g,font:{family:o,style:l,weight:h,decoration:m},halo:{size:(0,c.hf)(e.outlineSize,t,i,r)||0,color:p,style:l},pixelRatio:1,premultiplyColors:!this._avoidSDF};return this._textRasterizer.rasterizeText(s,x)}_rasterizePictureResource(e,t,a,r,n,s){const l=document.createElement("canvas"),h=l.getContext("2d");l.height=(0,i.F2)(Math.max(Math.abs(n.frame.ymax-n.frame.ymin),s)),l.width=(0,i.F2)(Math.abs(n.frame.xmax-n.frame.xmin));const c=h.createImageData(a,r);c.data.set(new Uint8ClampedArray(t.buffer));const m=this._imageDataToCanvas(c),f=h.createPattern(m,"repeat"),u=Math.cos((-e.cim.rotation||0)*Math.PI/180),g=Math.sin((-e.cim.rotation||0)*Math.PI/180);f.setTransform({m11:u,m12:g,m21:-g,m22:u,m41:(0,i.F2)(e.cim.offsetX)||0,m42:(0,i.F2)(e.cim.offsetY)||0});const d=n.canvasPaths;let y,p,x;(0,o.oU)(d)?(y=d.rings,h.fillStyle=f,p=h.fill,x=["evenodd"]):(0,o.l9)(d)&&(y=d.paths,h.strokeStyle=f,h.lineWidth=s,p=h.stroke,y[0][0][1]=l.height/2,y[0][1][1]=l.height/2),h.beginPath();for(const o of y){const e=o?o.length:0;if(e>1){let t=o[0];h.moveTo((0,i.F2)(t[0]),(0,i.F2)(t[1]));for(let a=1;a<e;++a)t=o[a],h.lineTo((0,i.F2)(t[0]),(0,i.F2)(t[1]));h.closePath()}}p.apply(h,x);const C=h.getImageData(0,0,l.width,l.height),z=new Uint8Array(C.data);return{size:[l.width,l.height],image:new Uint32Array(z.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}_getPictureResource(e,t){const a=this._pictureMarkerCache.get(e.materialHash);if(!a)return null;const r=a.height/a.width,n=t?r>1?(0,i.F2)(t):(0,i.F2)(t)/r:a.width,s=t?r>1?(0,i.F2)(t)*r:(0,i.F2)(t):a.height;return{image:this._imageTo32Array(a,n,s),width:n,height:s}}_embedCIMLayerInVectorMarker(e,t){const a=(0,o.oU)(t.geometry)?"CIMPolygonSymbol":"CIMLineSymbol";return{type:"CIMVectorMarker",frame:t.frame,markerGraphics:[{type:"CIMMarkerGraphic",geometry:t.geometry,symbol:{type:a,symbolLayers:[e]}}]}}}(null,!0),z=120;async function M(e,t={}){const{size:a,maxSize:n,node:s,opacity:o}=t,l=t.cimOptions||t,{feature:h,fieldMap:c,geometryType:m,style:f}=l,u=(0,r.kW)(e),g=Math.min(null!=a?a:u,null!=n?n:(0,i.Wz)(z));g!==u&&(e=e.clone(),(0,r.PI)(e,g,{preserveOutlineWidth:!0}));let d=3;e&&e.data&&e.data.symbol&&"CIMPointSymbol"!==e.data.symbol.type&&(d=1);const y=await C.rasterizeCIMSymbolAsync(e,h,c,m,{scaleFactor:d,style:f}),p=document.createElement("canvas");p.width=y.imageData.width,p.height=y.imageData.height,p.getContext("2d").putImageData(y.imageData,0,0);let x=p.width/d,M=p.height/d;if(null!=a&&(null==(null==t?void 0:t.scale)||(null==t?void 0:t.scale))){const e=x/M;x=e<=1?Math.ceil(g*e):g,M=e<=1?g:Math.ceil(g/e)}const w=new Image(x,M);return w.src=p.toDataURL(),null!=o&&(w.style.opacity=`${o}`),s&&s.appendChild(w),w}}}]);
//# sourceMappingURL=8829.6e52b8cf.chunk.js.map