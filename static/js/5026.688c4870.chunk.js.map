{"version":3,"file":"static/js/5026.688c4870.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/layers/graphics/sources/FeatureLayerSource.js","../node_modules/@arcgis/core/layers/graphics/sources/support/clientSideDefaults.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/has.js\";import{fixJson as r}from\"../../../core/lang.js\";import{setDeepValue as a}from\"../../../core/object.js\";import{isSome as s,isNone as o}from\"../../../core/maybe.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import{property as i}from\"../../../core/accessorSupport/decorators/property.js\";import{subclass as u}from\"../../../core/accessorSupport/decorators/subclass.js\";import n from\"../../../core/Error.js\";import{dataComponents as l}from\"../../../core/urlUtils.js\";import\"../../../core/uuid.js\";import\"../../../portal/support/resourceExtension.js\";import d from\"../../../geometry/Extent.js\";import c from\"../../../request.js\";import h from\"../../../core/Loadable.js\";import y from\"../../../TimeExtent.js\";import{unapplyEditsZUnitScaling as p}from\"../../../rest/query/operations/zscale.js\";import{processAttachmentQueryResult as m}from\"../../../rest/query/operations/queryAttachments.js\";import f from\"../../../tasks/QueryTask.js\";import{createDrawingInfo as g}from\"./support/clientSideDefaults.js\";async function b(e){if(\"string\"==typeof e){const t=l(e);return t||{data:e}}return new Promise(((t,r)=>{const a=new FileReader;a.readAsDataURL(e),a.onload=()=>t(l(a.result)),a.onerror=e=>r(e)}))}const F=new Set([\"Feature Layer\",\"Table\"]);let R=class extends h{constructor(){super(...arguments),this.type=\"feature-layer\"}load(e){const t=s(e)?e.signal:null;return this.addResolvingPromise(this._fetchService(t)),Promise.resolve(this)}get queryTask(){const{capabilities:{query:{supportsFormatPBF:e}},parsedUrl:r,dynamicDataSource:a,gdbVersion:s,spatialReference:o,fieldsIndex:i}=this.layer,u=t(\"featurelayer-pbf\")&&e?\"pbf\":\"json\";return new f({url:r.path,format:u,fieldsIndex:i,dynamicDataSource:a,gdbVersion:s,sourceSpatialReference:o})}async addAttachment(e,t){await this.load();const r=e.attributes[this.layer.objectIdField],a=this.layer.parsedUrl.path+\"/\"+r+\"/addAttachment\",s=this._getLayerRequestOptions(),o=this._getFormDataForAttachment(t,s.query);try{const e=await c(a,{body:o});return this._createFeatureEditResult(e.data.addAttachmentResult)}catch(i){throw this._createAttachmentErrorResult(r,i)}}async updateAttachment(e,t,r){await this.load();const a=e.attributes[this.layer.objectIdField],s=this.layer.parsedUrl.path+\"/\"+a+\"/updateAttachment\",o=this._getLayerRequestOptions({query:{attachmentId:t}}),i=this._getFormDataForAttachment(r,o.query);try{const e=await c(s,{body:i});return this._createFeatureEditResult(e.data.updateAttachmentResult)}catch(u){throw this._createAttachmentErrorResult(a,u)}}async applyEdits(e,t){await this.load();const r=e.addFeatures.map(this._serializeFeature,this),a=e.updateFeatures.map(this._serializeFeature,this),s=this._getFeatureIds(e.deleteFeatures,null==t?void 0:t.globalIdUsed);p(r,a,this.layer.spatialReference);const o=[],i=[],u=[...e.deleteAttachments];for(const c of e.addAttachments)o.push(await this._serializeAttachment(c));for(const c of e.updateAttachments)i.push(await this._serializeAttachment(c));const n=o.length||i.length||u.length?{adds:o,updates:i,deletes:u}:null,l=this._getLayerRequestOptions({method:\"post\",query:{adds:r.length?JSON.stringify(r):null,updates:a.length?JSON.stringify(a):null,deletes:s.length?null!=t&&t.globalIdUsed?JSON.stringify(s):s.join(\",\"):null,gdbVersion:(null==t?void 0:t.gdbVersion)||this.layer.gdbVersion,rollbackOnFailure:null==t?void 0:t.rollbackOnFailureEnabled,useGlobalIds:null==t?void 0:t.globalIdUsed,attachments:n&&JSON.stringify(n)}}),d=await c(this.layer.parsedUrl.path+\"/applyEdits\",l);return this._createEditsResult(d)}async deleteAttachments(e,t){await this.load();const r=e.attributes[this.layer.objectIdField],a=this.layer.parsedUrl.path+\"/\"+r+\"/deleteAttachments\";try{return(await c(a,this._getLayerRequestOptions({query:{attachmentIds:t.join(\",\")},method:\"post\"}))).data.deleteAttachmentResults.map(this._createFeatureEditResult)}catch(s){throw this._createAttachmentErrorResult(r,s)}}fetchRecomputedExtents(e={}){const t=e.signal;return this.load({signal:t}).then((async()=>{const t=this._getLayerRequestOptions({...e,query:{returnUpdates:!0}}),{layerId:r,url:a}=this.layer,{data:s}=await c(`${a}/${r}`,t),{id:o,extent:i,fullExtent:u,timeExtent:n}=s,l=i||u;return{id:o,fullExtent:l&&d.fromJSON(l),timeExtent:n&&y.fromJSON({start:n[0],end:n[1]})}}))}async queryAttachments(e,t={}){const{parsedUrl:r}=this.layer,a=r.path;await this.load();const s=this._getLayerRequestOptions(t);if(!this.layer.get(\"capabilities.operations.supportsQueryAttachments\")){const{objectIds:t}=e,r=[];for(const e of t){const t=a+\"/\"+e+\"/attachments\";r.push(c(t,s))}return Promise.all(r).then((e=>t.map(((t,r)=>({parentObjectId:t,attachmentInfos:e[r].data.attachmentInfos}))))).then((e=>m(e,a)))}return this.queryTask.executeAttachmentQuery(e,s)}async queryFeatures(e,t){return await this.load(),this.queryTask.execute(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryFeaturesJSON(e,t){return await this.load(),this.queryTask.executeJSON(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryObjectIds(e,t){return await this.load(),this.queryTask.executeForIds(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryFeatureCount(e,t){return await this.load(),this.queryTask.executeForCount(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryExtent(e,t){return await this.load(),this.queryTask.executeForExtent(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryRelatedFeatures(e,t){return await this.load(),this.queryTask.executeRelationshipQuery(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryRelatedFeaturesCount(e,t){return await this.load(),this.queryTask.executeRelationshipQueryForCount(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async _fetchService(e){let r=this.layer.sourceJSON;if(!r){const{data:a}=await c(this.layer.parsedUrl.path,this._getLayerRequestOptions({query:t(\"featurelayer-advanced-symbols\")?{returnAdvancedSymbols:!0}:{},signal:e}));r=a}this.sourceJSON=this._patchServiceJSON(r);const a=r.type;if(!F.has(a))throw new n(\"feature-layer-source:unsupported-type\",`Source type \"${a}\" is not supported`)}_patchServiceJSON(e){var t;if(\"Table\"!==e.type&&e.geometryType&&(null==e||null==(t=e.drawingInfo)||!t.renderer)&&!e.defaultSymbol){const t=g(e.geometryType).renderer;a(\"drawingInfo.renderer\",t,e)}return e}_serializeFeature(e){const{geometry:t,attributes:r}=e;return o(t)?{attributes:r}:\"mesh\"===t.type||\"extent\"===t.type?null:{geometry:t.toJSON(),attributes:r}}async _serializeAttachment(e){const{feature:t,attachment:r}=e,{globalId:a,name:s,contentType:o,data:i,uploadId:u}=r,n={globalId:a,parentGlobalId:null,contentType:null,name:null,uploadId:null,data:null};if(t&&(n.parentGlobalId=\"attributes\"in t?t.attributes&&t.attributes[this.layer.globalIdField]:t.globalId),u)n.uploadId=u;else if(i){const e=await b(i);n.contentType=e.mediaType,n.data=e.data,i instanceof File&&(n.name=i.name)}return s&&(n.name=s),o&&(n.contentType=o),n}_getFeatureIds(e,t){const r=e[0];return r?this._canUseGlobalIds(t,e)?this._getGlobalIdsFromFeatureIdentifier(e):\"objectId\"in r?this._getObjectIdsFromFeatureIdentifier(e):this._getIdsFromFeatures(e):[]}_getIdsFromFeatures(e){const t=this.layer.objectIdField;return e.map((e=>e.attributes&&e.attributes[t]))}_canUseGlobalIds(e,t){return e&&\"globalId\"in t[0]}_getObjectIdsFromFeatureIdentifier(e){return e.map((e=>e.objectId))}_getGlobalIdsFromFeatureIdentifier(e){return e.map((e=>e.globalId))}_createEditsResult(e){const t=e.data,r=e.data&&e.data.attachments;return{addFeatureResults:t.addResults?t.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:t.updateResults?t.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:t.deleteResults?t.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:r&&r.addResults?r.addResults.map(this._createFeatureEditResult,this):[],updateAttachmentResults:r&&r.updateResults?r.updateResults.map(this._createFeatureEditResult,this):[],deleteAttachmentResults:r&&r.deleteResults?r.deleteResults.map(this._createFeatureEditResult,this):[]}}_createFeatureEditResult(e){const t=!0===e.success?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:t?new n(\"feature-layer-source:edit-failure\",t.description,{code:t.code}):null}}_createAttachmentErrorResult(e,t){const r=t.details.messages&&t.details.messages[0]||t.message,a=t.details.httpStatus||t.details.messageCode;return{objectId:e,globalId:null,error:new n(\"feature-layer-source:attachment-failure\",r,{code:a})}}_getFormDataForAttachment(e,t){const r=e instanceof FormData?e:e&&e.elements?new FormData(e):null;if(r)for(const a in t){const e=t[a];null!=e&&(r.set?r.set(a,e):r.append(a,e))}return r}_getLayerRequestOptions(e={}){const{parsedUrl:t,gdbVersion:a,dynamicDataSource:s}=this.layer;return{...e,query:r({gdbVersion:a,layer:s?JSON.stringify({source:s}):void 0,...t.query,f:\"json\",...this.layer.customParameters,...null==e?void 0:e.query}),responseType:\"json\"}}};e([i()],R.prototype,\"type\",void 0),e([i({constructOnly:!0})],R.prototype,\"layer\",void 0),e([i({readOnly:!0})],R.prototype,\"queryTask\",null),R=e([u(\"esri.layers.graphics.sources.FeatureLayerSource\")],R);var q=R;export default q;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport t from\"../../../../core/has.js\";import{clone as r}from\"../../../../core/lang.js\";import{defaultPointSymbolJSON as e,defaultPolylineSymbolJSON as n,defaultPolygonSymbolJSON as o}from\"../../../../symbols/support/defaultsJSON.js\";function i(t){return{renderer:{type:\"simple\",symbol:\"esriGeometryPoint\"===t||\"esriGeometryMultipoint\"===t?e:\"esriGeometryPolyline\"===t?n:o}}}function s(r,e){if(t(\"csp-restrictions\"))return()=>({[e]:null,...r});try{let t=`this.${e} = null;`;for(const e in r){t+=`this${e.indexOf(\".\")?`[\"${e}\"]`:`.${e}`} = ${JSON.stringify(r[e])};`}const n=new Function(t);return()=>new n}catch(n){return()=>({[e]:null,...r})}}function u(t={}){return[{name:\"New Feature\",description:\"\",prototype:{attributes:r(t)}}]}export{s as createDefaultAttributesFunction,u as createDefaultTemplate,i as createDrawingInfo};\n"],"names":["F","Set","R","h","constructor","super","arguments","this","type","load","e","t","s","signal","addResolvingPromise","_fetchService","Promise","resolve","queryTask","capabilities","query","supportsFormatPBF","parsedUrl","r","dynamicDataSource","a","gdbVersion","spatialReference","o","fieldsIndex","i","layer","u","f","url","path","format","sourceSpatialReference","addAttachment","attributes","objectIdField","_getLayerRequestOptions","_getFormDataForAttachment","c","body","_createFeatureEditResult","data","addAttachmentResult","_createAttachmentErrorResult","updateAttachment","attachmentId","updateAttachmentResult","applyEdits","addFeatures","map","_serializeFeature","updateFeatures","_getFeatureIds","deleteFeatures","globalIdUsed","p","deleteAttachments","addAttachments","push","_serializeAttachment","updateAttachments","n","length","adds","updates","deletes","l","method","JSON","stringify","join","rollbackOnFailure","rollbackOnFailureEnabled","useGlobalIds","attachments","d","_createEditsResult","attachmentIds","deleteAttachmentResults","fetchRecomputedExtents","then","async","returnUpdates","layerId","id","extent","fullExtent","timeExtent","fromJSON","y","start","end","queryAttachments","get","objectIds","all","parentObjectId","attachmentInfos","m","executeAttachmentQuery","queryFeatures","execute","customParameters","queryFeaturesJSON","executeJSON","queryObjectIds","executeForIds","queryFeatureCount","executeForCount","queryExtent","executeForExtent","queryRelatedFeatures","executeRelationshipQuery","queryRelatedFeaturesCount","executeRelationshipQueryForCount","sourceJSON","returnAdvancedSymbols","_patchServiceJSON","has","geometryType","drawingInfo","renderer","defaultSymbol","g","geometry","toJSON","feature","attachment","globalId","name","contentType","uploadId","parentGlobalId","globalIdField","FileReader","readAsDataURL","onload","result","onerror","b","mediaType","File","_canUseGlobalIds","_getGlobalIdsFromFeatureIdentifier","_getObjectIdsFromFeatureIdentifier","_getIdsFromFeatures","objectId","addFeatureResults","addResults","updateFeatureResults","updateResults","deleteFeatureResults","deleteResults","addAttachmentResults","updateAttachmentResults","success","error","code","description","details","messages","message","httpStatus","messageCode","FormData","elements","set","append","source","responseType","prototype","constructOnly","readOnly","symbol","indexOf","Function"],"sourceRoot":""}