{"version":3,"file":"static/js/1319.c01d229a.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/renderers/support/clickToleranceUtils.js","../node_modules/@arcgis/core/views/layers/TileLayerView.js","../node_modules/@arcgis/core/views/2d/layers/TileLayerView2D.js","../node_modules/@arcgis/core/views/support/drapedUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nfunction t(t,e){return e?\"xoffset\"in e&&e.xoffset?Math.max(t,Math.abs(e.xoffset)):\"yoffset\"in e&&e.yoffset?Math.max(t,Math.abs(e.yoffset||0)):t:t}function e(t){let e=0,n=0;for(let r=0;r<t.length;r++){const s=t[r].size;\"number\"==typeof s&&(e+=s,n++)}return e/n}function n(t,n){return\"number\"==typeof t?t:t&&t.stops&&t.stops.length?e(t.stops):n}function r(t,e){if(!e)return t;const r=e.filter((t=>\"size\"===t.type)).map((e=>{const{maxSize:r,minSize:s}=e;return(n(r,t)+n(s,t))/2}));let s=0;const o=r.length;if(0===o)return t;for(let n=0;n<o;n++)s+=r[n];const f=Math.floor(s/o);return Math.max(f,t)}function s(e){const n=e&&e.renderer,s=\"touch\"===(e&&e.event&&e.event.pointerType)?9:6;if(!n)return s;const o=\"visualVariables\"in n?r(s,n.visualVariables):s;if(\"simple\"===n.type)return t(o,n.symbol);if(\"unique-value\"===n.type){let e=o;return n.uniqueValueInfos.forEach((n=>{e=t(e,n.symbol)})),e}if(\"class-breaks\"===n.type){let e=o;return n.classBreakInfos.forEach((n=>{e=t(e,n.symbol)})),e}return n.type,o}export{s as calculateTolerance};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../core/has.js\";import{isSome as r}from\"../../core/maybe.js\";import\"../../core/Logger.js\";import\"../../core/accessorSupport/ensureType.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import{subclass as o}from\"../../core/accessorSupport/decorators/subclass.js\";import s from\"../../core/Error.js\";import\"../../core/urlUtils.js\";import\"../../core/uuid.js\";import\"../../portal/support/resourceExtension.js\";import{eachAlways as p}from\"../../core/promiseUtils.js\";import{calculateTolerance as a}from\"../../renderers/support/clickToleranceUtils.js\";const i=i=>{let c=class extends i{async fetchPopupFeatures(e,t){const{layer:o}=this;if(!e)return Promise.reject(new s(\"tilelayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:o}));if(\"tile\"!==o.type)return Promise.reject(new s(\"tilelayerview:fetchPopupFeatures\",\"Layer type should be 'tile'\",{type:o.type}));const i=this.get(\"view.scale\"),c=o.allSublayers.toArray().filter((e=>{const r=0===e.minScale||i<=e.minScale,t=0===e.maxScale||i>=e.maxScale;return e.popupTemplate&&e.popupEnabled&&e.visible&&r&&t}));return p(c.map((async o=>{const s=o.createQuery(),p=r(t)?t.event:null,i=a({renderer:o.renderer,event:p});s.geometry=this.createFetchPopupFeaturesQueryGeometry(e,i),s.outFields=await o.popupTemplate.getRequiredFields();return(await o.queryFeatures(s)).features}))).then((e=>[].concat(...e.map((e=>e.value)).filter(Boolean))))}};return e([t()],c.prototype,\"layer\",void 0),c=e([o(\"esri.layers.mixins.TileLayerView\")],c),c};export default i;export{i as TileLayerView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import\"../../../core/has.js\";import{isNone as t}from\"../../../core/maybe.js\";import i from\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import{property as r}from\"../../../core/accessorSupport/decorators/property.js\";import{subclass as s}from\"../../../core/accessorSupport/decorators/subclass.js\";import a from\"../../../core/Error.js\";import\"../../../core/urlUtils.js\";import\"../../../core/uuid.js\";import\"../../../portal/support/resourceExtension.js\";import{isAbortError as l}from\"../../../core/promiseUtils.js\";import o from\"../tiling/TileKey.js\";import{RefreshableLayerView as h}from\"../../layers/RefreshableLayerView.js\";import n from\"../tiling/TileInfoView.js\";import c from\"../tiling/TileQueue.js\";import u from\"../tiling/TileStrategy.js\";import m from\"../../layers/LayerView.js\";import{createQueryGeometry as p}from\"../../support/drapedUtils.js\";import{TileLayerView as f}from\"../../layers/TileLayerView.js\";import{LayerView2DMixin as g}from\"./LayerView2D.js\";import{BitmapTileLayerView2D as y}from\"./BitmapTileLayerView2D.js\";const w=i.getLogger(\"esri.views.2d.layers.TileLayerView2D\"),d=[0,0];let _=class extends(f(h(y(g(m))))){constructor(){super(...arguments),this._tileStrategy=null,this._fetchQueue=null,this.layer=null}initialize(){const e=this.layer.tileInfo,t=e&&e.spatialReference;let i;t||(i=new a(\"layerview:tiling-information-missing\",\"The layer doesn't provide tiling information\",{layer:this.layer})),t.equals(this.view.spatialReference)||(i=new a(\"layerview:spatial-reference-incompatible\",\"The spatial reference of this layer does not meet the requirements of the view\",{layer:this.layer})),this.watch(\"resampling\",(()=>{this.refresh()})),i&&this.addResolvingPromise(Promise.reject(i))}get resampling(){return!(\"resampling\"in this.layer)||!1!==this.layer.resampling}hitTest(){return null}update(e){this._fetchQueue.pause(),this._fetchQueue.state=e.state,this._tileStrategy.update(e),this._fetchQueue.resume(),this.notifyChange(\"updating\")}attach(){const e=\"tileServers\"in this.layer?this.layer.tileServers:null;this._tileInfoView=new n(this.layer.tileInfo,this.layer.fullExtent),this._fetchQueue=new c({tileInfoView:this._tileInfoView,concurrency:e&&10*e.length||10,process:(e,t)=>this.fetchTile(e,t)}),this._tileStrategy=new u({cachePolicy:\"keep\",resampling:this.resampling,acquireTile:e=>this.acquireTile(e),releaseTile:e=>this.releaseTile(e),tileInfoView:this._tileInfoView}),this.requestUpdate(),this.container.requestRender(),super.attach()}detach(){super.detach(),this._tileStrategy.destroy(),this._fetchQueue.clear(),this.container.removeAllChildren(),this._fetchQueue=this._tileStrategy=this._tileInfoView=null}moveStart(){this.requestUpdate()}viewChange(){this.requestUpdate()}moveEnd(){this.requestUpdate()}createFetchPopupFeaturesQueryGeometry(e,t){return p(e,t,this.view)}async doRefresh(){this.updateRequested||this.suspended||(this._fetchQueue.reset(),this._tileStrategy.tiles.forEach((e=>this._enqueueTileFetch(e))),this.notifyChange(\"updating\"))}isUpdating(){var e;return(null==(e=this._fetchQueue)?void 0:e.length)>0}acquireTile(e){const t=this._bitmapView.createTile(e),i=t.bitmap;return[i.x,i.y]=this._tileInfoView.getTileCoords(d,t.key),i.resolution=this._tileInfoView.getTileResolution(t.key),[i.width,i.height]=this._tileInfoView.tileInfo.size,this._enqueueTileFetch(t),this._bitmapView.addChild(t),this.requestUpdate(),t}releaseTile(e){this._fetchQueue.abort(e.key.id),this._bitmapView.removeChild(e),e.once(\"detach\",(()=>e.destroy())),this.requestUpdate()}async fetchTile(e,i){const r=\"tilemapCache\"in this.layer?this.layer.tilemapCache:null,s=!t(i)&&i.signal;if(!r)try{return await this._fetchImage(e,s)}catch(m){if(!l(m)&&!this.resampling)return this._createBlankImage();throw m}const a=new o(0,0,0,0);let h;try{if(await r.fetchAvailabilityUpsample(e.level,e.row,e.col,a,{signal:s}),a.level!==e.level&&!this.resampling)return this._createBlankImage();h=await this._fetchImage(a,s)}catch(m){if(l(m))throw m;h=await this._fetchImage(e,s)}const{level:n,row:c,col:u}=a;return this.resampling&&n!==e.level?this._resampleImage(h,n,c,u,e.level,e.row,e.col):h}async _enqueueTileFetch(e){if(!this._fetchQueue.has(e.key.id)){try{const t=await this._fetchQueue.push(e.key);e.bitmap.source=t,e.bitmap.width=this._tileInfoView.tileInfo.size[0],e.bitmap.height=this._tileInfoView.tileInfo.size[1],e.once(\"attach\",(()=>this.requestUpdate()))}catch(t){l(t)||w.error(t)}this.requestUpdate()}}async _fetchImage(e,t){return this.layer.fetchTile(e.level,e.row,e.col,{timestamp:this.refreshTimestamp,signal:t})}_resampleImage(e,t,i,r,s,a,l){const o=this._tileInfoView.tileInfo.size,h=this._tileInfoView.getTileResolution(t),n=this._tileInfoView.getTileResolution(s);let c=this._tileInfoView.getLODInfoAt(s);const u=c.getXForColumn(l),m=c.getYForRow(a);c=this._tileInfoView.getLODInfoAt(t);const p=c.getXForColumn(r),f=c.getYForRow(i),g=Math.round((u-p)/h),y=Math.round(-(m-f)/h),w=Math.round(o[0]*(n/h)),d=Math.round(o[1]*(n/h)),_=this._createBlankImage();return _.getContext(\"2d\").drawImage(e,g,y,w,d,0,0,o[0],o[1]),_}_createBlankImage(){const e=this._tileInfoView.tileInfo.size,t=document.createElement(\"canvas\");return[t.width,t.height]=e,t}};e([r()],_.prototype,\"resampling\",null),_=e([s(\"esri.views.2d.layers.TileLayerView2D\")],_);var I=_;export default I;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as t}from\"../../core/maybe.js\";import r from\"../../geometry/Extent.js\";import\"../../geometry.js\";import{getMetersPerUnitForSR as n}from\"../../core/unitUtils.js\";import{calculateTolerance as i}from\"../../renderers/support/clickToleranceUtils.js\";function a(t,i,a,o=new r){let s;if(\"2d\"===a.type)s=i*a.resolution;else if(\"3d\"===a.type){const r=a.overlayPixelSizeInMapUnits(t),o=a.basemapSpatialReference;s=e(o)&&!o.equals(a.spatialReference)?n(o)/n(a.spatialReference):i*r}const m=t.x-s,p=t.y-s,c=t.x+s,l=t.y+s,{spatialReference:f}=a;return o.xmin=Math.min(m,c),o.ymin=Math.min(p,l),o.xmax=Math.max(m,c),o.ymax=Math.max(p,l),o.spatialReference=f,o}function o(e,r,n){const o=n.toMap(e);if(t(o))return!1;return a(o,i(),n,s).intersects(r)}const s=new r;export{a as createQueryGeometry,o as intersectsDrapedGeometry};\n"],"names":["t","e","xoffset","Math","max","abs","yoffset","n","stops","length","r","s","size","filter","type","map","maxSize","minSize","o","f","floor","renderer","event","pointerType","visualVariables","symbol","uniqueValueInfos","forEach","classBreakInfos","i","c","fetchPopupFeatures","layer","this","Promise","reject","get","allSublayers","toArray","minScale","maxScale","popupTemplate","popupEnabled","visible","p","async","createQuery","a","geometry","createFetchPopupFeaturesQueryGeometry","outFields","getRequiredFields","queryFeatures","features","then","concat","value","Boolean","prototype","w","getLogger","d","_","h","y","g","m","constructor","super","arguments","_tileStrategy","_fetchQueue","initialize","tileInfo","spatialReference","equals","view","watch","refresh","addResolvingPromise","resampling","hitTest","update","pause","state","resume","notifyChange","attach","tileServers","_tileInfoView","fullExtent","tileInfoView","concurrency","process","fetchTile","u","cachePolicy","acquireTile","releaseTile","requestUpdate","container","requestRender","detach","destroy","clear","removeAllChildren","moveStart","viewChange","moveEnd","doRefresh","updateRequested","suspended","reset","tiles","_enqueueTileFetch","isUpdating","_bitmapView","createTile","bitmap","x","getTileCoords","key","resolution","getTileResolution","width","height","addChild","abort","id","removeChild","once","tilemapCache","signal","_fetchImage","l","_createBlankImage","fetchAvailabilityUpsample","level","row","col","_resampleImage","has","push","source","error","timestamp","refreshTimestamp","getLODInfoAt","getXForColumn","getYForRow","round","getContext","drawImage","document","createElement","overlayPixelSizeInMapUnits","basemapSpatialReference","xmin","min","ymin","xmax","ymax"],"sourceRoot":""}